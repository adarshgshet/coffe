<!DOCTYPE html>
<html>
<head>
<title>Order Coffee</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header>
<h1>Coffee Cafe</h1>
<nav>
<a href="index.html">Home</a>
<a href="order.html">Order</a>
<a href="admin.html">Admin</a>
</nav>
</header>

<section class="menu-section">
<h2>Your Cart</h2>
<div id="cartList"></div>
<h3 id="totalPrice"></h3>
<h3>Your Details</h3>
<input id="custName" placeholder="Name"><br><br>
<input id="custPhone" placeholder="10-digit Phone number"><br><br>
<button onclick="placeOrder()">Place Order</button>
<p id="orderResponse"></p>
<hr><br>
</section>

<script>
let cart=JSON.parse(localStorage.getItem("cart")||"[]");

function loadCart(){
    let html="", total=0;
    cart.forEach(i=>{ html+=`<p>${i.name} - ₹${i.price}</p>`; total+=i.price; });
    document.getElementById("cartList").innerHTML=html;
    document.getElementById("totalPrice").innerText="Total: ₹"+total.toFixed(2);
}
loadCart();

const custName=document.getElementById("custName"), custPhone=document.getElementById("custPhone"), orderResponse=document.getElementById("orderResponse");
custName.addEventListener("keypress", e=>{ if(e.key==="Enter") custPhone.focus(); });
custPhone.addEventListener("keypress", e=>{ if(e.key==="Enter") placeOrder(); });

function placeOrder(){
    let name=custName.value.trim(), phone=custPhone.value.trim();
    if(!name || !/^\d{10}$/.test(phone) || cart.length===0){ alert("Invalid input or empty cart"); return;}
    fetch('place_order.php',{method:'POST', body:JSON.stringify({name,phone,cart})})
    .then(res=>res.json()).then(data=>{
        if(data.status==="success"){ cart=[]; localStorage.removeItem("cart"); loadCart(); orderResponse.innerText=data.msg;}
        else alert(data.msg);
    });
}
</script>
</body>
</html>
